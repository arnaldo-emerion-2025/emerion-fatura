program EEstoque;

uses
  Forms,
  Windows,
  Dialogs,
  SysUtils,
  Bberro in '..\..\..\..\_wgLib\Lib\Bberro.pas',
  Bbfuncao in '..\..\..\..\_wgLib\Lib\Bbfuncao.pas',
  Bbmensag in '..\..\..\..\_wgLib\Lib\Bbmensag.pas',
  BbQFuncao in '..\..\..\..\_wgLib\Lib\BbQfuncao.pas',
  Bbgeral in '..\..\..\..\_wgLib\Lib\Bbgeral.pas',
  Frelpadrao in '..\..\..\..\_wgLib\Padrao\Frelpadrao.pas' {fmRelPadrao},
  BbGetText in '..\..\..\..\_wgLib\Lib\Bbgettext.pas',
  ManTUs in '..\..\..\..\_WGLIB\padrao\ManTUs.pas' {fmManTUs},
  ManTSe in '..\..\..\..\_WGLIB\padrao\ManTse.pas' {fmManTSe},
  Fpadrao in '..\..\..\..\_WGLIB\padrao\Fpadrao.pas' {fmPadrao},
  Fpreview in '..\..\..\..\_WGLIB\padrao\Fpreview.pas' {fmPreview},
  ManGDB in '..\..\..\..\_WGLIB\padrao\ManGDB.pas' {fmManGDB: TDataModule},
  ManInf in '..\..\..\..\_WGLIB\padrao\ManInf.pas' {fmManInf},
  ManStr in 'ManStr.pas' {fmManStr},
  ManLog in '..\..\..\..\_WGLIB\padrao\ManLog.pas' {fmManLog},
  AuxCod in 'AuxCod.pas' {fmAuxCod},
  AuxPro in 'AuxPro.pas' {fmAuxPro},
  VerUsu in '..\..\..\..\_WGLIB\padrao\VerUsu.pas' {fmVerUsu},
  ManCat in 'ManCat.pas' {fmManCat},
  ManCor in 'ManCor.pas' {fmManCor},
  ManEmb in 'ManEmb.pas' {fmManEmb},
  ManIpi in 'ManIpi.pas' {fmManIpi},
  ManGru in 'ManGru.pas' {fmManGru},
  ManDef in '..\..\..\..\_WGLIB\padrao\ManDef.pas' {fmManDef},
  Bbacesso in '..\..\..\..\_WGLIB\lib\Bbacesso.pas',
  SadReg in '..\..\..\..\_WGLIB\padrao\SadReg.pas' {fmSadReg},
  ManEnf in 'ManEnf.pas' {fmManEnf},
  ManSda in 'ManSda.pas' {fmManSda},
  PsqCpr in '..\..\..\..\_WGLIB\PadraoPsq\PsqCpr.pas' {fmPsqCpr},
  ManIcm in 'ManIcm.pas' {fmManIcm},
  PsqCor in '..\..\..\..\_WGLIB\PadraoPsq\PsqCor.pas' {fmPsqCor},
  PsqEmb in '..\..\..\..\_WGLIB\PadraoPsq\PsqEmb.pas' {fmPsqEmb},
  PsqIcms in '..\..\..\..\_WGLIB\PadraoPsq\PsqIcms.pas' {fmPsqIcms},
  PsqSub in '..\..\..\..\_WGLIB\PadraoPsq\PsqSub.pas' {fmPsqSub},
  PsqCom in '..\..\..\..\_WGLIB\PadraoPsq\PsqCom.pas' {fmPsqCom},
  PsqOpe in '..\..\..\..\_WGLIB\PadraoPsq\PsqOpe.pas' {fmPsqOpe},
  ManPar in 'ManPar.pas' {fmManPar},
  ManAce in '..\..\..\..\_WGLIB\padrao\ManAce.pas' {fmManAce},
  ManAtu in '..\..\..\..\_WGLIB\padrao\ManAtu.pas' {fmManAtu},
  PsqIpi in '..\..\..\..\_WGLIB\PadraoPsq\PsqIpi.pas' {fmPsqIpi},
  PsqStr in '..\..\..\..\_WGLIB\PadraoPsq\PsqStr.pas' {fmPsqStr},
  EstR01 in 'EstR01.pas' {fmEstR01},
  EstR04 in 'EstR04.pas' {fmEstR04},
  EstR05 in 'EstR05.pas' {fmEstR05},
  PsqPro in '..\..\..\..\_WGLIB\PadraoPsq\PsqPro.pas' {fmPsqPro},
  AuxIni in '..\..\..\..\_WGLIB\PadraoPsq\AuxIni.pas' {fmAuxIni},
  PsqGru in '..\..\..\..\_WGLIB\PadraoPsq\PsqGru.pas' {fmPsqGru},
  PsqRef in '..\..\..\..\_WGLIB\PadraoPsq\PsqRef.pas' {fmPsqRef},
  EstR09 in 'EstR09.pas' {fmEstR09},
  FMensag in '..\..\..\..\_WGLIB\padrao\FMensag.pas' {fmMensag},
  FMsgConf in '..\..\..\..\_WGLIB\padrao\FMsgConf.pas' {fmMsgConf},
  ManTip in 'ManTip.pas' {fmManTip},
  ManRef in 'ManRef.pas' {fmManRef},
  ManSds in 'ManSds.pas' {fmManSds},
  ManMrc in 'ManMrc.pas' {fmManMrc},
  PsqMrc in '..\..\..\..\_WGLIB\PadraoPsq\PsqMrc.pas' {fmPsqMrc},
  PsqTip in '..\..\..\..\_WGLIB\PadraoPsq\PsqTip.pas' {fmPsqTip},
  ManEnv in 'ManEnv.pas' {fmManEnv},
  ManImp in 'ManImp.pas' {fmManImp},
  ManPrc in 'ManPrc.pas' {fmManPrc},
  ColR06 in 'ColR06.pas' {fmColR06},
  ManCol in 'ManCol.pas' {fmManCol},
  AuxPsq in '..\..\..\..\_WGLIB\PadraoPsq\AuxPsq.pas' {fmAuxPsq},
  ManPri in 'ManPri.pas' {fmManPri},
  PsqEco in '..\..\..\..\_WGLIB\PadraoPsq\PsqEco.pas' {fmPsqEco},
  ConPar in 'ConPar.pas' {fmConPar},
  EstR07 in 'EstR07.pas' {fmEstR07},
  ManNro in 'ManNro.pas' {fmManDsc},
  ManPro in 'ManPro.pas' {fmManPro},
  ManBar in 'ManBar.pas' {fmManBar},
  FShowpadrao in '..\..\..\..\_WGLIB\padrao\FShowpadrao.pas' {fmShowPadrao},
  ManBDE in '..\..\..\..\_WGLIB\padrao\ManBDE.pas' {fmManBDE},
  ManApl in '..\..\..\..\_WGLIB\padrao\ManApl.pas' {fmManApl},
  ManCba in 'ManCba.pas' {fmManCba},
  ConClf in 'ConClf.pas' {fmConClf},
  EstR10 in 'EstR10.pas' {fmEstR10},
  EstR08 in 'EstR08.pas' {fmEstR08},
  ManTxf in 'ManTxf.pas' {fmManTxf},
  ManTrf in 'ManTrf.pas' {fmManTrf},
  ManUnd in 'ManUnd.pas' {fmManUnd},
  ManApr in 'ManApr.pas' {fmManApr},
  EstR03 in 'EstR03.pas' {fmEstR03},
  EstR12 in 'EstR12.pas' {fmEstR12},
  ManEns in 'ManEns.pas' {fmManEns},
  ManUfe in 'ManUfe.pas' {fmManUfe},
  EstR11 in 'EstR11.pas' {fmEstR11},
  EstR02 in 'EstR02.pas' {fmEstR02},
  ManCom in '..\..\..\..\_WGLIB\padrao\ManCom.pas' {fmManCom},
  ManPfa in 'ManPfa.pas' {fmManPfa};

{$R *.RES}
  var
  sAlias    : string;
  HprevHist : HWND;

begin

  Application.Initialize;

  if not FileExists('C:\Windows\Emerion.prg') then
     HprevHist := FindWindow(Nil,'Emerion Estoque')
  else
     HprevHist := 0;

  if HprevHist = 0 then begin

     Application.Title := 'Emerion Estoque';

     try

        fmManApl := TFmManApl.Create(Application);

        fmManApl.Show;
        fmManApl.Refresh;

        sAlias := fmManApl.sAlias;

     finally

        FreeAndNil(fmManApl);

     end;

     if sAlias = 'S' then begin

        Application.CreateForm(TfmManGDB, fmManGDB);
  Application.CreateForm(TfmManPri, fmManPri);
  end;

     Application.Run;

     end
  else
     MessageDlg('Existe uma Cópia do Aplicativo em Execução no Momento.', mtInformation, [mbOK], 0);
end.
